# This file is dual licensed under the terms of the Apache License, Version
# 2.0, and the BSD License. See the LICENSE file in the root of this repository
# for complete details.
INCLUDES = '\n\n#include <openssl/pkcs7.h>\n\n'
TYPES = '\n\ntypedef struct {\n\n    Cryptography_STACK_OF_X509 *cert;\n\n    Cryptography_STACK_OF_X509_CRL *crl;\n\n    ...;\n\n} PKCS7_SIGNED;\n\n\n\ntypedef struct {\n\n    Cryptography_STACK_OF_X509 *cert;\n\n    Cryptography_STACK_OF_X509_CRL *crl;\n\n    ...;\n\n} PKCS7_SIGN_ENVELOPE;\n\n\n\ntypedef ... PKCS7_DIGEST;\n\ntypedef ... PKCS7_ENCRYPT;\n\ntypedef ... PKCS7_ENVELOPE;\n\ntypedef ... PKCS7_SIGNER_INFO;\n\n\n\ntypedef struct {\n\n    ASN1_OBJECT *type;\n\n    union {\n\n        char *ptr;\n\n        ASN1_OCTET_STRING *data;\n\n        PKCS7_SIGNED *sign;\n\n        PKCS7_ENVELOPE *enveloped;\n\n        PKCS7_SIGN_ENVELOPE *signed_and_enveloped;\n\n        PKCS7_DIGEST *digest;\n\n        PKCS7_ENCRYPT *encrypted;\n\n        ASN1_TYPE *other;\n\n     } d;\n\n    ...;\n\n} PKCS7;\n\n\n\nstatic const int PKCS7_BINARY;\n\nstatic const int PKCS7_DETACHED;\n\nstatic const int PKCS7_NOATTR;\n\nstatic const int PKCS7_NOCERTS;\n\nstatic const int PKCS7_NOCHAIN;\n\nstatic const int PKCS7_NOINTERN;\n\nstatic const int PKCS7_NOSIGS;\n\nstatic const int PKCS7_NOSMIMECAP;\n\nstatic const int PKCS7_NOVERIFY;\n\nstatic const int PKCS7_STREAM;\n\nstatic const int PKCS7_TEXT;\n\nstatic const int PKCS7_PARTIAL;\n\n'
FUNCTIONS = '\n\nvoid PKCS7_free(PKCS7 *);\n\nPKCS7 *PKCS7_sign(X509 *, EVP_PKEY *, Cryptography_STACK_OF_X509 *,\n\n                   BIO *, int);\n\nint SMIME_write_PKCS7(BIO *, PKCS7 *, BIO *, int);\n\nint PEM_write_bio_PKCS7_stream(BIO *, PKCS7 *, BIO *, int);\n\nPKCS7_SIGNER_INFO *PKCS7_sign_add_signer(PKCS7 *, X509 *, EVP_PKEY *,\n\n                                         const EVP_MD *, int);\n\nint PKCS7_final(PKCS7 *, BIO *, int);\n\n/* Included verify due to external consumer, see\n\n   https://github.com/pyca/cryptography/issues/5433 */\n\nint PKCS7_verify(PKCS7 *, Cryptography_STACK_OF_X509 *, X509_STORE *, BIO *,\n\n                 BIO *, int);\n\nPKCS7 *SMIME_read_PKCS7(BIO *, BIO **);\n\n/* Included due to external consumer, see\n\n   https://github.com/pyca/pyopenssl/issues/1031 */\n\nCryptography_STACK_OF_X509 *PKCS7_get0_signers(PKCS7 *,\n\n                                               Cryptography_STACK_OF_X509 *,\n\n                                               int);\n\n\n\nint PKCS7_type_is_signed(PKCS7 *);\n\nint PKCS7_type_is_enveloped(PKCS7 *);\n\nint PKCS7_type_is_signedAndEnveloped(PKCS7 *);\n\nint PKCS7_type_is_data(PKCS7 *);\n\n'
CUSTOMIZATIONS = ''